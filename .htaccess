# 05.02.2026 06:24

# Включаем необходимые модули
Options +Includes -Indexes
ServerSignature Off

# Настройка MIME-типов и фильтров
AddType text/html .html
AddOutputFilter INCLUDES .html

# Включаем движок перезаписи
RewriteEngine On
RewriteBase /

# === Безопасность ===
# Защита от прямого доступа к чувствительным файлам
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Запрет доступа к .htaccess
<Files ".htaccess">
    Require all denied
</Files>

# === Обработка ошибок ===
ErrorDocument 404 /service-pages/404/

# === Оптимизация производительности ===
# Включение сжатия
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Кэширование статических ресурсов
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/woff2 "access plus 1 year"
</IfModule>

# Заголовки для кэширования
<IfModule mod_headers.c>
    Header set Cache-Control "max-age=2592000, public"
    <FilesMatch "\.(ico|jpg|jpeg|png|gif|webp|svg|woff|woff2)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>
    <FilesMatch "\.(css|js)$">
        Header set Cache-Control "max-age=2678400, public"
    </FilesMatch>
</IfModule>

# === Перенаправления ===

# Универсальное правило для добавления слеша в конце
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ $1/ [L,R=301]

# Объединенные правила перенаправлений
RewriteRule ^(about|download)/?$ /kfbrand/ [R=301,L]


# Articles
RewriteRule ^(artemy)/?$ /articles/$1/ [R=301,L]


# Fonts



# Other pages
RewriteRule ^(bottle-caps|cv|history|personal|showreel|useful)/?$ /other-pages/$1/ [R=301,L]


# Personal projects
RewriteRule ^(1523tv|birthday|desktops|kfbrand|minecraft-posters|posters)/?$ /personal-projects/$1/ [R=301,L]


# Projects
RewriteRule ^(1ppc|aesthete|amusevill|amusics|default|lumet|melectron|morfin|morfinizm|morfinizm-lyrics|nuqun|oh-my-toast|stickers|wild-mathing)/?$ /projects/$1/ [R=301,L]


# Service pages
RewriteRule ^(404|all-pages)/?$ /service-pages/$1/ [R=301,L]